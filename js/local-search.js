$(document).ready(function(){$.ajax({url:"/search.xml",dataType:"xml",success:function(t){var e=$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),n=document.getElementById("local-search-input"),r=document.getElementById("local-search-result");n.addEventListener("input",function(){var t='<ul class="list-unstyled mb-0">',n=this.value.trim().toLowerCase().split(/[\s\-]+/);if(r.innerHTML="",!(this.value.trim().length<=0)){if(e.forEach(function(e){var r=!0;e.title&&""!==e.title.trim()||(e.title="Untitled");var a=e.title.trim().toLowerCase(),l=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),i=e.url,s=-1,c=-1,u=-1;if(""!==l?n.forEach(function(t,e){s=a.indexOf(t),c=l.indexOf(t),s<0&&c<0?r=!1:(c<0&&(c=0),0==e&&(u=c))}):r=!1,r){t+="<li><a href='"+i+"' class='list-link h5 heading'>"+a+"</a>";var o=e.content.trim().replace(/<[^>]+>/g,"");if(u>=0){var h=u-20,f=u+80;h<0&&(h=0),0==h&&(f=100),f>o.length&&(f=o.length);var d=o.substr(h,f);n.forEach(function(t){var e=new RegExp(t,"gi");d=d.replace(e,'<span class="search-keyword text-danger">'+t+"</span>")}),t+='<p class="search-result">'+d+"...</p>"}t+="</li>"}}),t+="</ul>",-1===t.indexOf("<li>"))return r.innerHTML="<ul><span class='local-search-empty'>没有找到内容，换个搜索词试试吧<span></ul>";r.innerHTML=t}})}})});
